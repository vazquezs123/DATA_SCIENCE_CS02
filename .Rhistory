setwd("C:\Users\vazqu\\Documents\\SMU\\data_science\\CaseStudy2_2\\DATA_SCIENCE_CS02")
setwd("C:\\Users\vazqu\\Documents\\SMU\\data_science\\CaseStudy2_2\\DATA_SCIENCE_CS02")
setwd("C:\\Users\\vazqu\\Documents\\SMU\\data_science\\CaseStudy2_2\\DATA_SCIENCE_CS02")
library(openxlsx)
library(MASS)
library(ggplot2)
attritionData <- read.xlsx("CaseStudy2-data.xlsx")
# general landscape of attritiion - how many attritions?
# clearly more no; not common to leave
attritionYesCount <- length(attritionData$Attrition[attritionData$Attrition== "Yes"]) # 237
attritionNoCount <- length(attritionData$Attrition[attritionData$Attrition== "No"]) # 1233
attritionData$Attrition <- ifelse(attritionData$Attrition=="Yes", 1, 0)
attritionData$Age <- as.integer(attritionData$Age)
attritionData$AgeGroups <- cut(attritionData$Age, breaks=c(10,20,30,40,50,60))
attritionData$MonthlyIncomeGroup <-cut(attritionData$MonthlyIncome, breaks=5)
attritionData$LoggedMonthlyIncomeGroup <- log(attritionData$MonthlyIncome)
attritionYesData <- attritionData[attritionData$Attrition == 1,]
head(attritionData$LoggedMonthlyIncomeGroup)
head(attritionData$MonthlyIncomeGroup)
attritionData$MonthlyIncomeGroup
attritionData$MonthlyIncomeGroup <-cut(attritionData$MonthlyIncome,
breaks=data.frame(
classIntervals(
attritionData$MonthlyIncome, n=5,
method="quantile")[2][,1],
include.lowest=T,dig.lab=10)
)
attritionData$MonthlyIncomeGroup <-cut(attritionData$MonthlyIncome,
breaks=data.frame(
classIntervals(
attritionData$MonthlyIncome, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
install.packages("classint")
install.packages("classInt")
attritionData$MonthlyIncomeGroup <-cut(attritionData$MonthlyIncome,
breaks=data.frame(
classIntervals(
attritionData$MonthlyIncome, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
library(classInt)
attritionData$MonthlyIncomeGroup <-cut(attritionData$MonthlyIncome,
breaks=data.frame(
classIntervals(
attritionData$MonthlyIncome, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
ggplot(attritionData, aes(x = MonthlyIncomeGroup, y = Attrition)) +
geom_bar(stat = "identity", fill = "#5EA9BE") +
theme(panel.background = element_rect(fill = "#FDF8E2"),
axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Attrition Plot by Monthly Income")
attritionData$YearlyIncomeGroup <-cut(attritionData$YearlyIncome,
breaks=data.frame(
classIntervals(
attritionData$YearlyIncome, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
attritionData$YearlyIncomeGroup <-attritionData$MonthlyIncomeGroup * 12
attritionData$YearlyIncomeGroup <- multiply(attritionData$MonthlyIncomeGroup,12)
attritionData$YearlyIncomeGroup <- attritionData$MonthlyIncomeGroup*12
attritionData$YearlyIncome <- attritionData$MonthlyIncome*12
attritionData$YearlyIncomeGroup <- cut(attritionData$YearlyIncomeGroup,
breaks=data.frame(
classIntervals(
attritionData$YearlyIncomeGroup, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
attritionData$YearlyIncome <- attritionData$MonthlyIncome*12
attritionData$YearlyIncomeGroup <- cut(attritionData$YearlyIncome,
breaks=data.frame(
classIntervals(
attritionData$YearlyIncome, n=5,
method="quantile")[2])[,1],
include.lowest=T,dig.lab=10)
ggplot(attritionData, aes(x = YearlyIncomeGroup, y = Attrition)) +
geom_bar(stat = "identity", fill = "#5EA9BE") +
theme(panel.background = element_rect(fill = "#FDF8E2"),
axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5),
xlim(7,8)), ylim(0) +
labs(title = "Attrition Plot by Yearly Income")
ggplot(attritionData, aes(x = YearlyIncomeGroup, y = Attrition)) +
geom_bar(stat = "identity", fill = "#5EA9BE") +
theme(panel.background = element_rect(fill = "#FDF8E2"),
axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5) +
labs(title = "Attrition Plot by Yearly Income")
ggplot(attritionData, aes(x = YearlyIncomeGroup, y = Attrition)) +
geom_bar(stat = "identity", fill = "#5EA9BE") +
theme(panel.background = element_rect(fill = "#FDF8E2"),
axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Attrition Plot by Yearly Income")
